<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>行业利润数据分析</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .chart-row {
            display: flex;
            width: 100%;
            margin-bottom: 30px;
        }
        .chart-container {
            width: 48%;
            height: 500px;
            margin-bottom: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            padding: 15px;
            box-sizing: border-box;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.12);
        }
        .chart-container.left {
            margin-right: 2%;
        }
        .chart-container.right {
            margin-left: 2%;
        }
        @media (max-width: 768px) {
            .chart-row {
                flex-direction: column;
            }
            .chart-container {
                width: 100%;
                margin-left: 0 !important;
                margin-right: 0 !important;
            }
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 28px;
            font-weight: 600;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        h2 {
            text-align: center;
            font-size: 16px;
            margin-top: 0;
            color: #34495e;
            font-weight: 600;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
    </style>
</head>
<body>
    <h1>行业利润数据分析 2025-10</h1>
    <p style="text-align: center; color: #666; margin-top: -10px; margin-bottom: 20px;">数据来源: 国家统计局， 生成时间: 2025-12-18</p>
    <div class="container">
        <!-- 第一行图表 -->
        <div class="chart-row">
            <div class="chart-container left" id="profit-top10">
                <h2>2025年利润总额前10名</h2>
            </div>
            <div class="chart-container right" id="profit-bottom10">
                <h2>2025年利润总额后10名</h2>
            </div>
        </div>
        
        <!-- 第二行图表 -->
        <div class="chart-row">
            <div class="chart-container left" id="per-capita-profit-top10">
                <h2>2025年人均创造利润前10名</h2>
            </div>
            <div class="chart-container right" id="per-capita-profit-bottom10">
                <h2>2025年人均创造利润后10名</h2>
            </div>
        </div>
        
        <!-- 第三行图表 -->
        <div class="chart-row">
            <div class="chart-container left" id="profit-growth-top10">
                <h2>过去1年 利润增长率前10名</h2>
            </div>
            <div class="chart-container right" id="profit-growth-bottom10">
                <h2>过去1年 利润增长率后10名</h2>
            </div>
        </div>
        
        <!-- 第四行图表 -->
        <div class="chart-row">
            <div class="chart-container left" id="per-capita-growth-top10">
                <h2>过去1年 人均创造利润增长率前10名</h2>
            </div>
            <div class="chart-container right" id="per-capita-growth-bottom10">
                <h2>过去1年 人均创造利润增长率后10名</h2>
            </div>
        </div>
    </div>

    <script>
        // 直接嵌入CSV数据
        const csvData = `
industry,利润总额,人均创造利润,利润增长率,人均创造利润增长率
采矿业,7123.3,18.255509994874423,-0.27647710074858045,-0.2523720323470725
煤炭开采和洗选业,2570.4,10.310469314079423,-0.492176386913229,-0.4785284999991441
石油和天然气开采业,2790.6,56.60446247464503,-0.12695532474033291,-0.11810091626913945
黑色金属矿采选业,381.8,16.819383259911895,-0.2214518760195758,-0.18372487441700025
有色金属矿采选业,1050.6,44.142857142857146,0.3275208491281273,0.29963175565904926
非金属矿采选业,303.8,13.442477876106194,-0.04525455688246379,0.00543989142466187
开采专业及辅助性活动,25.9,1.15625,-2.9044117647058822,-3.244485294117647
其他采矿业,0.2,inf,-0.7500000000000001,inf
制造业,45050.3,6.830874437082076,0.06695860796578187,0.060924195132447324
农副食品加工业,1024.9,4.352016985138004,0.0789556795452154,0.08674431927017
食品制造业,1417.2,8.620437956204379,0.018542475204829635,0.009249204445661498
酒、饮料和精制茶制造业,2610.2,28.248917748917748,0.06638885484332231,0.10101186961096253
烟草制品业,1660.4,105.75796178343948,0.0030810125052861334,0.01585911457541699
纺织业,540.8,2.208248264597795,-0.0685497760936963,-0.0655070640515359
纺织服装、服饰业,353.8,1.7968511934992382,-0.2322048611111111,-0.21153795285254787
皮革、毛皮、羽毛及其制品和制鞋业,310.2,2.3270817704426108,-0.14380347778084465,-0.11554192715995719
木材加工和木、竹、藤、棕、草制品业,177.9,2.470833333333333,-0.24682472480948342,-0.17464542760372576
家具制造业,214.4,2.516431924882629,-0.1982049364248316,-0.15303338354735746
造纸和纸制品业,312.1,3.4988789237668163,-0.12577030812324924,-0.11988983934380923
印刷和记录媒介复制业,250.9,3.363270777479893,-0.022213561964146596,0.00006843461307806545
文教、工美、体育和娱乐用品制造业,439.5,3.1038135593220337,-0.107795371498173,-0.10716528348369428
石油、煤炭及其他燃料加工业,-126.3,-1.8519061583577712,-0.6651643690349947,-0.6553451423204785
化学原料和化学制品制造业,3117.7,9.399155863732288,-0.07664741596327564,-0.08555524915265617
医药制造业,2698.4,13.539387857501254,-0.031408162532754226,-0.016828255295414936
化学纤维制造业,207.8,4.843822843822844,-0.0397412199630314,-0.048694681781557926
橡胶和塑料制品业,1257.4,4.4509734513274335,-0.04212691399405801,-0.062132051011527266
非金属矿物制品业,1291.0,3.486362408857683,0.01741666009929853,0.07456563803628333
黑色金属冶炼和压延加工业,1053.2,6.0389908256880735,-5.516295025728988,-5.573266637292083
有色金属冶炼和压延加工业,2891.7,19.239520958083833,0.1212050715365825,0.12791887436015487
金属制品业,1325.8,3.7409706546275396,-0.006221422681957841,-0.006501834244406524
通用设备制造业,2820.0,6.62127259920169,0.0706963322955425,0.04832207224052884
专用设备制造业,2206.9,6.339844872163171,0.032467836257309986,0.01348537675703188
汽车制造业,3894.6,7.9271320985141465,0.03626639704121537,-0.019839212894254374
铁路、船舶、航空航天和其他运输设备制造业,1126.0,9.648671808054841,0.31958279620297675,0.2438226870807835
电气机械和器材制造业,5004.4,8.29779472724258,0.04936045292514146,0.039616764421774295
计算机、通信和其他电子设备制造业,5700.4,6.263487528842984,0.10711025655965352,0.07633354027467464
仪器仪表制造业,843.6,8.278704612365063,0.052001496445940945,0.026191842460515296
其他制造业,91.9,3.494296577946768,-0.09813542688910697,-0.07070228398079081
废弃资源综合利用业,161.3,6.610655737704918,0.3330578512396695,0.2893510364449261
金属制品、机械和设备修理业,172.4,6.223826714801444,-0.02212138400453775,-0.1209683199174365
电力、热力、燃气及水生产和供应业,7329.3,21.89811771735883,0.10848457350272235,0.12471276116380195
电力、热力生产和供应业,6264.8,25.85555096987206,0.1396554546942933,0.16129150542311613
燃气生产和供应业,650.1,17.522911051212937,-0.07287507130633203,-0.05288315909730416
水的生产和供应业,414.4,7.493670886075949,0.0016920473773265378,-0.007364842743625755
        `.trim();

        // 解析CSV数据
        function parseCSV(data) {
            const lines = data.split('\n');
            const headers = lines[0].split(',');
            const rows = lines.slice(1);
            
            return rows.map(row => {
                const values = row.split(',');
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = isNaN(values[index]) ? values[index] : parseFloat(values[index]);
                });
                return obj;
            });
        }

        // 获取前N名和后N名（按要求排序）
        function getTopAndBottom(data, key, n = 10) {
            // 过滤掉无效数据和制造业
            const filteredData = data.filter(item => isFinite(item[key]) && item.industry !== '制造业');
            
            // 获取前N名（从大到小）
            const sortedTop = [...filteredData].sort((a, b) => b[key] - a[key]);
            const top = sortedTop.slice(0, n);
            
            // 获取后N名（从小到大）
            const sortedBottom = [...filteredData].sort((a, b) => a[key] - b[key]);
            const bottom = sortedBottom.slice(0, n);
            
            // 为了图表显示效果，将数据反转以适应从上到下的显示
            // 前10名保持从大到小的顺序（在图表中从上到下显示）
            // 后10名保持从小到大的顺序（在图表中从上到下显示）
            top.reverse();
            bottom.reverse(); // 不反转后10名，保持从小到大的顺序
            
            return { top, bottom };
        }

        // 创建柱状图
        function createBarChart(containerId, data, valueKey, labelFormatter = null, isHorizontal = true) {
            const container = document.getElementById(containerId);
            // 创建一个新的div用于图表，避免与标题冲突
            const chartDiv = document.createElement('div');
            chartDiv.style.width = '100%';
            chartDiv.style.height = 'calc(100% - 30px)'; // 减去标题高度
            container.appendChild(chartDiv);
            
            const chart = echarts.init(chartDiv);
            
            // 获取容器内的标题文本
            const titleElement = container.querySelector('h2');
            const titleText = titleElement ? titleElement.innerText : '';
            
            const option = {
                title: {
                    text: titleText,
                    textStyle: {
                        fontSize: 14
                    },
                    left: 'center',
                    top: 10
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    },
                    formatter: function(params) {
                        const param = params[0];
                        return `${param.name}<br/>${param.seriesName}: ${(labelFormatter ? labelFormatter(param.value) : param.value.toFixed(2))}`;
                    },
                    backgroundColor: 'rgba(255, 255, 255, 0.9)',
                    borderColor: '#ccc',
                    borderWidth: 1,
                    textStyle: {
                        color: '#333',
                        fontSize: 12
                    },
                    extraCssText: 'box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true,
                    top: 50,  // 为标题留出空间
                    backgroundColor: 'rgba(245, 245, 245, 0.1)',
                    borderColor: '#e0e0e0',
                    borderWidth: 1
                },
                xAxis: {
                    type: 'value',
                    axisLine: {
                        lineStyle: {
                            color: '#999'
                        }
                    },
                    axisLabel: {
                        formatter: labelFormatter || '{value}',
                        color: '#666'
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: '#eee',
                            type: 'dashed'
                        }
                    }
                },
                yAxis: {
                    type: 'category',
                    data: data.map(item => item.industry),
                    axisLine: {
                        lineStyle: {
                            color: '#999'
                        }
                    },
                    axisLabel: {
                        fontSize: 11,
                        color: '#333',
                        fontWeight: 'normal'
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: '#eee'
                        }
                    }
                },
                series: [{
                    name: '',
                    type: 'bar',
                    data: data.map(item => item[valueKey]),
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                            { offset: 0, color: '#83bff6' },
                            { offset: 0.5, color: '#188df0' },
                            { offset: 1, color: '#5470c6' }
                        ]),
                        shadowColor: 'rgba(0, 0, 0, 0.2)',
                        shadowBlur: 3,
                        emphasis: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.4)'
                        }
                    },
                    label: {
                        show: true,
                        position: 'right',
                        formatter: function(params) {
                            return labelFormatter ? labelFormatter(params.value) : params.value.toFixed(2);
                        },
                        fontSize: 10,
                        fontWeight: 'bold'
                    },
                    barWidth: '60%',
                    barGap: '20%',
                    animationDuration: 1000,
                    animationEasing: 'elasticOut',
                    animationDelay: function (idx) {
                        return idx * 50;
                    }
                }]
            };
            
            chart.setOption(option);
            return chart;
        }

        // 页面加载完成后执行
        window.onload = function() {
            // 解析数据
            const data = parseCSV(csvData);
            
            // 1. 2025年利润总额前10名和后10名
            const profit2025 = getTopAndBottom(data, '利润总额');
            createBarChart('profit-top10', profit2025.top, '利润总额', function(value) {
                return (value / 1).toFixed(2) + '亿元';
            });
            createBarChart('profit-bottom10', profit2025.bottom, '利润总额', function(value) {
                return (value / 1).toFixed(2) + '亿元';
            });
            
            // 2. 2025年人均创造利润前10名和后10名
            const perCapitaProfit2025 = getTopAndBottom(data, '人均创造利润');
            createBarChart('per-capita-profit-top10', perCapitaProfit2025.top, '人均创造利润', function(value) {
                return (value / 1).toFixed(2) + '万元';
            });
            createBarChart('per-capita-profit-bottom10', perCapitaProfit2025.bottom, '人均创造利润', function(value) {
                return (value / 1).toFixed(2) + '万元';
            });
            
            // 3. 利润增长率前10名和后10名
            const profitGrowth = getTopAndBottom(data, '利润增长率');
            createBarChart('profit-growth-top10', profitGrowth.top, '利润增长率', function(value) {
                return (value * 100).toFixed(2) + '%';
            });
            createBarChart('profit-growth-bottom10', profitGrowth.bottom, '利润增长率', function(value) {
                return (value * 100).toFixed(2) + '%';
            });
            
            // 4. 人均创造利润增长率前10名和后10名
            const perCapitaGrowth = getTopAndBottom(data, '人均创造利润增长率');
            createBarChart('per-capita-growth-top10', perCapitaGrowth.top, '人均创造利润增长率', function(value) {
                return (value * 100).toFixed(2) + '%';
            });
            createBarChart('per-capita-growth-bottom10', perCapitaGrowth.bottom, '人均创造利润增长率', function(value) {
                return (value * 100).toFixed(2) + '%';
            });
            
            // 窗口大小调整时重绘图表
            window.addEventListener('resize', () => {
                // 重新获取所有图表容器并调整大小
                const containers = document.querySelectorAll('.chart-container');
                containers.forEach(container => {
                    // 查找容器内通过createBarChart创建的图表div
                    const chartDiv = container.querySelector('div');
                    if (chartDiv && chartDiv._echarts_instance_) {
                        const chartInstance = echarts.getInstanceByDom(chartDiv);
                        if (chartInstance) {
                            chartInstance.resize();
                        }
                    }
                });
            });
        };
    </script>
</body>
</html>