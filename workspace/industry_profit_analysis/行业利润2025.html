<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>行业利润数据分析</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .chart-row {
            display: flex;
            width: 100%;
            margin-bottom: 30px;
        }
        .chart-container {
            width: 48%;
            height: 500px;
            margin-bottom: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            padding: 15px;
            box-sizing: border-box;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.12);
        }
        .chart-container.left {
            margin-right: 2%;
        }
        .chart-container.right {
            margin-left: 2%;
        }
        @media (max-width: 768px) {
            .chart-row {
                flex-direction: column;
            }
            .chart-container {
                width: 100%;
                margin-left: 0 !important;
                margin-right: 0 !important;
            }
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 28px;
            font-weight: 600;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        h2 {
            text-align: center;
            font-size: 16px;
            margin-top: 0;
            color: #34495e;
            font-weight: 600;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
    </style>
</head>
<body>
    <h1>行业利润数据分析 2025-10</h1>
    <p style="text-align: center; color: #666; margin-top: -10px; margin-bottom: 20px;">数据来源: 国家统计局， 生成时间: 2025-12-18</p>
    <div class="container">
        <!-- 第一行图表 -->
        <div class="chart-row">
            <div class="chart-container left" id="profit-top10">
                <h2>2025年利润总额前10名</h2>
            </div>
            <div class="chart-container right" id="profit-bottom10">
                <h2>2025年利润总额后10名</h2>
            </div>
        </div>
        
        <!-- 第二行图表 -->
        <div class="chart-row">
            <div class="chart-container left" id="per-capita-profit-top10">
                <h2>2025年人均创造利润前10名</h2>
            </div>
            <div class="chart-container right" id="per-capita-profit-bottom10">
                <h2>2025年人均创造利润后10名</h2>
            </div>
        </div>
        
        <!-- 第三行图表 -->
        <div class="chart-row">
            <div class="chart-container left" id="profit-growth-top10">
                <h2>过去1年 利润增长率前10名</h2>
            </div>
            <div class="chart-container right" id="profit-growth-bottom10">
                <h2>过去1年 利润增长率后10名</h2>
            </div>
        </div>
        
        <!-- 第四行图表 -->
        <div class="chart-row">
            <div class="chart-container left" id="per-capita-growth-top10">
                <h2>过去1年 人均创造利润增长率前10名</h2>
            </div>
            <div class="chart-container right" id="per-capita-growth-bottom10">
                <h2>过去1年 人均创造利润增长率后10名</h2>
            </div>
        </div>
    </div>

    <script>
        // 直接嵌入CSV数据
        const csvData = `
industry,利润总额,人均创造利润,利润增长率,人均创造利润增长率
采矿业,70362.1,47684428.218529165,-0.27647710074858045,-0.2523720323470725
煤炭开采和洗选业,30261.4,30482386.793442994,-0.492176386913229,-0.4785284999991441
石油和天然气开采业,26034.8,5932183.5418164525,-0.12695532474033291,-0.11810091626913945
黑色金属矿采选业,3443.4,2784359.9815112525,-0.2214518760195758,-0.18372487441700025
有色金属矿采选业,7931.3,2823730.32240477,0.3275208491281273,0.29963175565904926
非金属矿采选业,2565.8,2812654.03866415,-0.04525455688246379,0.00543989142466187
开采专业及辅助性活动,118.50000000000001,2598311.143262092,-2.9044117647058822,-3.244485294117647
其他采矿业,6.4,0.0,-0.7500000000000001,inf
农副食品加工业,8919.1,28542886.742500477,0.0789556795452154,0.08674431927017
食品制造业,12458.8,19691650.435590148,0.018542475204829635,0.009249204445661498
酒、饮料和精制茶制造业,22678.3,11302979.376916632,0.06638885484332231,0.10101186961096253
烟草制品业,15625.1,1882784.4096479977,0.0030810125052861334,0.01585911457541699
纺织业,4912.9,29546288.930393312,-0.0685497760936963,-0.0655070640515359
纺织服装、服饰业,3478.2999999999997,24186664.676275074,-0.2322048611111111,-0.21153795285254787
皮革、毛皮、羽毛及其制品和制鞋业,2807.2,16404711.69115284,-0.14380347778084465,-0.11554192715995719
木材加工和木、竹、藤、棕、草制品业,1920.0,9268848.833559409,-0.24682472480948342,-0.17464542760372576
家具制造业,2003.8999999999999,10579578.314984592,-0.1982049364248316,-0.15303338354735746
造纸和纸制品业,2876.2,10796281.720662503,-0.12577030812324924,-0.11988983934380923
印刷和记录媒介复制业,2253.9,9086326.45703217,-0.022213561964146596,0.00006843461307806545
文教、工美、体育和娱乐用品制造业,3956.6000000000004,17088093.77595881,-0.107795371498173,-0.10716528348369428
石油、煤炭及其他燃料加工业,-2164.0,8346243.541755589,-0.6651643690349947,-0.6553451423204785
化学原料和化学制品制造业,27633.699999999997,39746737.85503769,-0.07664741596327564,-0.08555524915265617
医药制造业,24154.4,24142182.307056617,-0.031408162532754226,-0.016828255295414936
化学纤维制造业,1929.4,5145355.871829041,-0.0397412199630314,-0.048694681781557926
橡胶和塑料制品业,11035.2,33718307.06333975,-0.04212691399405801,-0.062132051011527266
非金属矿物制品业,10821.400000000001,45993660.39797997,0.01741666009929853,0.07456563803628333
黑色金属冶炼和压延加工业,4653.0,20982615.65620228,-5.516295025728988,-5.573266637292083
有色金属冶炼和压延加工业,23129.6,18066943.94405745,0.1212050715365825,0.12791887436015487
金属制品业,11431.2,42776987.588088825,-0.006221422681957841,-0.006501834244406524
通用设备制造业,23347.0,50765459.07498367,0.0706963322955425,0.04832207224052884
专用设备制造业,18587.6,41481839.183495656,0.032467836257309986,0.01348537675703188
汽车制造业,32779.3,57474300.715857744,0.03626639704121537,-0.019839212894254374
铁路、船舶、航空航天和其他运输设备制造业,8732.5,13723927.86689778,0.31958279620297675,0.2438226870807835
电气机械和器材制造业,41876.4,72398194.3091271,0.04936045292514146,0.039616764421774295
计算机、通信和其他电子设备制造业,43741.5,107515120.1018234,0.10711025655965352,0.07633354027467464
仪器仪表制造业,6987.5,12096022.615316307,0.052001496445940945,0.026191842460515296
其他制造业,843.3,3258430.42441379,-0.09813542688910697,-0.07070228398079081
废弃资源综合利用业,1197.5,2908435.2819065778,0.3330578512396695,0.2893510364449261
金属制品、机械和设备修理业,1346.0,3166672.207876416,-0.02212138400453775,-0.1209683199174365
电力、热力、燃气及水生产和供应业,60661.5,40440309.80525154,0.10848457350272235,0.12471276116380195
电力、热力生产和供应业,51325.0,29308212.693049867,0.1396554546942933,0.16129150542311613
燃气生产和供应业,6095.1,4504145.287426937,-0.07287507130633203,-0.05288315909730416
水的生产和供应业,3241.5,6623539.467734437,0.0016920473773265378,-0.007364842743625755
        `.trim();

        // 解析CSV数据
        function parseCSV(data) {
            const lines = data.split('\n');
            const headers = lines[0].split(',');
            const rows = lines.slice(1);
            
            return rows.map(row => {
                const values = row.split(',');
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header] = isNaN(values[index]) ? values[index] : parseFloat(values[index]);
                });
                return obj;
            });
        }

        // 获取前N名和后N名（按要求排序）
        function getTopAndBottom(data, key, n = 10) {
            // 过滤掉无效数据
            const filteredData = data.filter(item => isFinite(item[key]));
            
            // 获取前N名（从大到小）
            const sortedTop = [...filteredData].sort((a, b) => b[key] - a[key]);
            const top = sortedTop.slice(0, n);
            
            // 获取后N名（从小到大）
            const sortedBottom = [...filteredData].sort((a, b) => a[key] - b[key]);
            const bottom = sortedBottom.slice(0, n);
            
            // 为了图表显示效果，将数据反转以适应从上到下的显示
            // 前10名保持从大到小的顺序（在图表中从上到下显示）
            // 后10名保持从小到大的顺序（在图表中从上到下显示）
            top.reverse();
            bottom.reverse(); // 不反转后10名，保持从小到大的顺序
            
            return { top, bottom };
        }

        // 创建柱状图
        function createBarChart(containerId, data, valueKey, labelFormatter = null, isHorizontal = true) {
            const container = document.getElementById(containerId);
            // 创建一个新的div用于图表，避免与标题冲突
            const chartDiv = document.createElement('div');
            chartDiv.style.width = '100%';
            chartDiv.style.height = 'calc(100% - 30px)'; // 减去标题高度
            container.appendChild(chartDiv);
            
            const chart = echarts.init(chartDiv);
            
            // 获取容器内的标题文本
            const titleElement = container.querySelector('h2');
            const titleText = titleElement ? titleElement.innerText : '';
            
            const option = {
                title: {
                    text: titleText,
                    textStyle: {
                        fontSize: 14
                    },
                    left: 'center',
                    top: 10
                },
                tooltip: {
                    trigger: 'axis',
                    axisPointer: {
                        type: 'shadow'
                    },
                    formatter: function(params) {
                        const param = params[0];
                        return `${param.name}<br/>${param.seriesName}: ${(labelFormatter ? labelFormatter(param.value) : param.value.toFixed(2))}`;
                    },
                    backgroundColor: 'rgba(255, 255, 255, 0.9)',
                    borderColor: '#ccc',
                    borderWidth: 1,
                    textStyle: {
                        color: '#333',
                        fontSize: 12
                    },
                    extraCssText: 'box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);'
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true,
                    top: 50,  // 为标题留出空间
                    backgroundColor: 'rgba(245, 245, 245, 0.1)',
                    borderColor: '#e0e0e0',
                    borderWidth: 1
                },
                xAxis: {
                    type: 'value',
                    axisLine: {
                        lineStyle: {
                            color: '#999'
                        }
                    },
                    axisLabel: {
                        formatter: labelFormatter || '{value}',
                        color: '#666'
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: '#eee',
                            type: 'dashed'
                        }
                    }
                },
                yAxis: {
                    type: 'category',
                    data: data.map(item => item.industry),
                    axisLine: {
                        lineStyle: {
                            color: '#999'
                        }
                    },
                    axisLabel: {
                        fontSize: 11,
                        color: '#333',
                        fontWeight: 'normal'
                    },
                    splitLine: {
                        show: true,
                        lineStyle: {
                            color: '#eee'
                        }
                    }
                },
                series: [{
                    name: '',
                    type: 'bar',
                    data: data.map(item => item[valueKey]),
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 1, 0, [
                            { offset: 0, color: '#83bff6' },
                            { offset: 0.5, color: '#188df0' },
                            { offset: 1, color: '#5470c6' }
                        ]),
                        shadowColor: 'rgba(0, 0, 0, 0.2)',
                        shadowBlur: 3,
                        emphasis: {
                            shadowBlur: 10,
                            shadowColor: 'rgba(0, 0, 0, 0.4)'
                        }
                    },
                    label: {
                        show: true,
                        position: 'right',
                        formatter: function(params) {
                            return labelFormatter ? labelFormatter(params.value) : params.value.toFixed(2);
                        },
                        fontSize: 10,
                        fontWeight: 'bold'
                    },
                    barWidth: '60%',
                    barGap: '20%',
                    animationDuration: 1000,
                    animationEasing: 'elasticOut',
                    animationDelay: function (idx) {
                        return idx * 50;
                    }
                }]
            };
            
            chart.setOption(option);
            return chart;
        }

        // 页面加载完成后执行
        window.onload = function() {
            // 解析数据
            const data = parseCSV(csvData);
            
            // 1. 2025年利润总额前10名和后10名
            const profit2025 = getTopAndBottom(data, '利润总额');
            createBarChart('profit-top10', profit2025.top, '利润总额', function(value) {
                return (value / 10000).toFixed(2) + '万亿';
            });
            createBarChart('profit-bottom10', profit2025.bottom, '利润总额', function(value) {
                return (value / 1).toFixed(2) + '亿';
            });
            
            // 2. 2025年人均创造利润前10名和后10名
            const perCapitaProfit2025 = getTopAndBottom(data, '人均创造利润');
            createBarChart('per-capita-profit-top10', perCapitaProfit2025.top, '人均创造利润', function(value) {
                return (value / 10000).toFixed(2) + '万';
            });
            createBarChart('per-capita-profit-bottom10', perCapitaProfit2025.bottom, '人均创造利润', function(value) {
                return (value / 10000).toFixed(2) + '万';
            });
            
            // 3. 利润增长率前10名和后10名
            const profitGrowth = getTopAndBottom(data, '利润增长率');
            createBarChart('profit-growth-top10', profitGrowth.top, '利润增长率', function(value) {
                return (value * 100).toFixed(2) + '%';
            });
            createBarChart('profit-growth-bottom10', profitGrowth.bottom, '利润增长率', function(value) {
                return (value * 100).toFixed(2) + '%';
            });
            
            // 4. 人均创造利润增长率前10名和后10名
            const perCapitaGrowth = getTopAndBottom(data, '人均创造利润增长率');
            createBarChart('per-capita-growth-top10', perCapitaGrowth.top, '人均创造利润增长率', function(value) {
                return (value * 100).toFixed(2) + '%';
            });
            createBarChart('per-capita-growth-bottom10', perCapitaGrowth.bottom, '人均创造利润增长率', function(value) {
                return (value * 100).toFixed(2) + '%';
            });
            
            // 窗口大小调整时重绘图表
            window.addEventListener('resize', () => {
                // 重新获取所有图表容器并调整大小
                const containers = document.querySelectorAll('.chart-container');
                containers.forEach(container => {
                    // 查找容器内通过createBarChart创建的图表div
                    const chartDiv = container.querySelector('div');
                    if (chartDiv && chartDiv._echarts_instance_) {
                        const chartInstance = echarts.getInstanceByDom(chartDiv);
                        if (chartInstance) {
                            chartInstance.resize();
                        }
                    }
                });
            });
        };
    </script>
</body>
</html>